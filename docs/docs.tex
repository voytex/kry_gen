\documentclass[titlepage]{article}

\usepackage[czech]{babel}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage{dirtree}
\usepackage{amsmath}

\input{../control_study/schemes/database-glyph.tex}

\title{Generátor úloh do aplikované kryptografie\\Dokumentace}
\author{Michal Homola,\\Dominik Chrenčík,\\Jiří Marák,\\Vojtěch Lukáš}

\begin{document}
\maketitle

\tableofcontents

\section*{Úvod}
\addcontentsline{toc}{section}{Úvod}
Předmětem této dokumentace je představit vizi projektu s názvem \uv{Generátor kryptografických úloh}. První část bude věnována teoretickému popisu systému jako celku. \dots

\section{Architektura}
Schéma systému lze vidět na obr.\,\ref{fig:sys}. Úlohy jsou uloženy v SQL databázi. K~této databázi má přístup pouze webový PHP~server. Ten slouží jako \uv{prostředník} mezi klientem a databází. Dále do úloh vkládá generované hodnoty (klíče apod.).
Klientská aplikace funguje jako přístupový bod a sehrává roli prezentační vrstvy. Pro jednoduchost je vyvinuta v jazyce Python, využívá pouze konzolové pro\-středí. 
\begin{figure}[h!]
    \centering
    \input{../control_study/schemes/system-scheme.tex}    
    \caption{Schéma systému}
    \label{fig:sys}
\end{figure}

\subsection{Konstrukce databáze}
V tabulce \ref{tab:struktura_databaze} lze vidět strukturu SQL databáze. 
Sloupec \textbf{ID} slouží jako primární klíč databáze, \textbf{Kód} úlohy pak slouží pro snazší rozlišení úloh. V~buňce \textbf{Zadání} se nachází textový popis úlohy. Zde stojí za povšimnutí, že všechny číselné hodnoty důležité k výpočtu jsou nahrazeny zástupnými znaky \uv{$\$n$}. 
Na místa těchto znaků bude logika v back-endu vkládat vygenerované hodnoty. Díky tomu bude možno jednu úlohu řešit vícekrát, po\-kaž\-dé s jinými parametry. 
Pole \textbf{Výsledek} je záměrně prázdné~--~správný výsledek zde vloží až server, který tuto hodnotu vypočítá podle vygenerovaných parametrů. 

Uživatel si bude moct vybrat jaký typ bude chtít řešit, back-end si tuto úlohu podle jejího kódu vytáhne z databáze, opatří ji vygenerovanými operandy a spolu se správným výsledkem a nápovědou ji zašle uživateli, jak lze vidět v diagramu na obr.\, \textcolor{red}{TODO::diagram!}
 \begin{table}
    \centering
    \caption{Struktura SQL databáze}
    \label{tab:struktura_databaze}
    \vspace{.5em}
    \begin{tabular}[h]{| l | l | p{3.7cm} | l | l |}
        \hline
        \textbf{ID} & \textbf{Kód} & \textbf{Zadání} &  \textbf{Nápověda} & \textbf{Výsledek} \\
        \texttt{INT} & \texttt{VARCHAR(5)} & \texttt{TEXT} &  \texttt{TEXT} & \texttt{TEXT} \\
        \hline\hline
        1 & \texttt{PR} & Rozhodněte (ano/ne) zda je číslo $n=\$1$ prvočíslo  & \dots & \texttt{NULL} \\
        \hline
        2 & \texttt{RSAe} & Zašifrujte zprávu $m=\$4$, pomocí RSA kryptosystému. Prvočísla jsou $p=\$1;\ q=\$2$, a soukromý klíč je $e=\$3$  & \dots & \texttt{NULL} \\
        \hline
        \vdots & \vdots & \vdots & \vdots & \vdots \\
        \hline
    \end{tabular}
 \end{table}

 \subsection{Generátor hodnot}
Modul generace hodnot je pro tento projekt zcela klíčový. Byl implementován přímo v~rámci back-end serveru, taktéž v jazyce PHP. Pro každý typ úlohy byla vytvořena jedna funkce, která vygeneruje pseudonáhodné operandy a předá je jako svou návratovou hodnotu. 

Server pak podle kódu žádané úlohy zažádá o její prototyp SQL server a zavolá příslušnou funkci pro doplnění vygenerovaných hodnot. Takto upravenou úlohu zabalí jako JSON objekt a pošle uživateli. 

 \subsection{API}
Architektura back-endu je navržena podle doporučení REST API. Celé řešení je založeno na \cite{restapi}. Od začátku byl projekt vyvíjen přímo na serveru pro usnadnění přístupu. URL pro zasílání dotazů: \url{http://vut-fekt-mpckry-gr14.8u.cz/index.php}. Všechny implementované dotazy jsou zmíněny v tabulce \ref{tab:api}.
\begin{table}[h!]
    \centering
    \caption{API funkce serveru} 
    \label{tab:api}
    \vspace{.5em}
    \begin{tabular}{|c|c|c|}
        \hline
        \textbf{URL} & \textbf{popis} & \textbf{použití} \\
        \hline \hline
        \texttt{/alltasks} & zašle všechny úlohy z DB & \texttt{<url>/alltasks} \\
        \hline
        \texttt{/task?code=<code>} &zašle úlohu s daným kódem & \texttt{<url>/task?code=pr} \\
        \hline
        \texttt{/randomtask} & zašle náhodnou úlohu & \texttt{<url>/randomtask}\\
        \hline
    \end{tabular}
\end{table}

Jako odpověď na tyto dotazy server zašle JSON objekt, který bude již obsahovat vygenerované hodnoty i výsledek. 

\section{Komentáře}



\begin{thebibliography}{9}
    \bibitem{restapi}
    SONI, Sajal. How to build a simple REST API in PHP. \emph{En\-va\-to Tuts+} [on\-li\-ne]. 27-5-2021 [cit. 2023-03-25]. Dostupné z: \url{https://code.tutsplus.com/tutorials/how-to-build-a-simple-rest-api-in-php--cms-37000}
\end{thebibliography}

    

\end{document}